(function(h){function q(){this.regional=[];this.regional[""]={labels:["\u5e74","\u6708","\u5468","\u5929","\u65f6","\u5206","\u79d2"],labels1:["\u5e74","\u6708","\u5468","\u5929","\u65f6","\u5206","\u79d2"],compactLabels:["\u5e74","\u6708","\u5468","\u5929"],whichLabels:null,timeSeparator:":",isRTL:false};this._defaults={until:null,since:null,timezone:null,serverSync:null,format:"dHMS",layout:"",compact:false,significant:0,description:"",expiryUrl:"",expiryText:"",alwaysExpire:false,onExpiry:null,
onTick:null,tickInterval:1};h.extend(this._defaults,this.regional[""]);this._serverSyncs=[]}function r(a,b){h.extend(a,b);for(var c in b)if(b[c]==null)a[c]=null;return a}h.extend(q.prototype,{markerClassName:"hasCountdown",_timer:setInterval(function(){h.countdown._updateTargets()},980),_timerTargets:[],setDefaults:function(a){this._resetExtraLabels(this._defaults,a);r(this._defaults,a||{})},UTCDate:function(a,b,c,d,e,i,f,k){if(typeof b=="object"&&b.constructor==Date){k=b.getMilliseconds();f=b.getSeconds();
i=b.getMinutes();e=b.getHours();d=b.getDate();c=b.getMonth();b=b.getFullYear()}var j=new Date;j.setUTCFullYear(b);j.setUTCDate(1);j.setUTCMonth(c||0);j.setUTCDate(d||1);j.setUTCHours(e||0);j.setUTCMinutes((i||0)-(Math.abs(a)<30?a*60:a));j.setUTCSeconds(f||0);j.setUTCMilliseconds(k||0);return j},periodsToSeconds:function(a){return a[0]*31557600+a[1]*2629800+a[2]*604800+a[3]*86400+a[4]*3600+a[5]*60+a[6]},_settingsCountdown:function(a,b){if(!b)return h.countdown._defaults;var c=h.data(a,"countdown");
return b=="all"?c.options:c.options[b]},_attachCountdown:function(a,b){var c=h(a);if(!c.hasClass(this.markerClassName)){c.addClass(this.markerClassName);c={options:h.extend({},b),_periods:[0,0,0,0,0,0,0]};h.data(a,"countdown",c);this._changeCountdown(a)}},_addTarget:function(a){this._hasTarget(a)||this._timerTargets.push(a)},_hasTarget:function(a){return h.inArray(a,this._timerTargets)>-1},_removeTarget:function(a){this._timerTargets=h.map(this._timerTargets,function(b){return b==a?null:b})},_updateTargets:function(){for(var a=
this._timerTargets.length-1;a>=0;a--)this._updateCountdown(this._timerTargets[a])},_updateCountdown:function(a,b){var c=h(a);if(b=b||h.data(a,"countdown")){c.html(this._generateHTML(b));c[(this._get(b,"isRTL")?"add":"remove")+"Class"]("countdown_rtl");if(c=this._get(b,"onTick")){var d=b._hold!="lap"?b._periods:this._calculatePeriods(b,b._show,this._get(b,"significant"),new Date),e=this._get(b,"tickInterval");if(e==1||this.periodsToSeconds(d)%e==0)c.apply(a,[d])}if(b._hold!="pause"&&(b._since?b._now.getTime()<
b._since.getTime():b._now.getTime()>=b._until.getTime())&&!b._expiring){b._expiring=true;if(this._hasTarget(a)||this._get(b,"alwaysExpire")){this._removeTarget(a);(c=this._get(b,"onExpiry"))&&c.apply(a,[]);if(c=this._get(b,"expiryText")){d=this._get(b,"layout");b.options.layout=c;this._updateCountdown(a,b);b.options.layout=d}if(c=this._get(b,"expiryUrl"))window.location=c}b._expiring=false}else b._hold=="pause"&&this._removeTarget(a);h.data(a,"countdown",b)}},_changeCountdown:function(a,b,c){b=b||
{};if(typeof b=="string"){var d=b;b={};b[d]=c}if(c=h.data(a,"countdown")){this._resetExtraLabels(c.options,b);r(c.options,b);this._adjustSettings(a,c);h.data(a,"countdown",c);b=new Date;if(c._since&&c._since<b||c._until&&c._until>b)this._addTarget(a);this._updateCountdown(a,c)}},_resetExtraLabels:function(a,b){var c=false,d;for(d in b)if(d!="whichLabels"&&d.match(/[Ll]abels/)){c=true;break}if(c)for(d in a)if(d.match(/[Ll]abels[0-9]/))a[d]=null},_adjustSettings:function(a,b){var c,d=this._get(b,"serverSync"),
e=0;c=null;for(e=0;e<this._serverSyncs.length;e++)if(this._serverSyncs[e][0]==d){c=this._serverSyncs[e][1];break}if(c!=null){e=d?c:0;c=new Date}else{e=d?d.apply(a,[]):null;c=new Date;e=e?c.getTime()-e.getTime():0;this._serverSyncs.push([d,e])}d=this._get(b,"timezone");d=d==null?-c.getTimezoneOffset():d;b._since=this._get(b,"since");if(b._since!=null){b._since=this.UTCDate(d,this._determineTime(b._since,null));b._since&&e&&b._since.setMilliseconds(b._since.getMilliseconds()+e)}b._until=this.UTCDate(d,
this._determineTime(this._get(b,"until"),c));e&&b._until.setMilliseconds(b._until.getMilliseconds()+e);b._show=this._determineShow(b)},_destroyCountdown:function(a){var b=h(a);if(b.hasClass(this.markerClassName)){this._removeTarget(a);b.removeClass(this.markerClassName).empty();h.removeData(a,"countdown")}},_pauseCountdown:function(a){this._hold(a,"pause")},_lapCountdown:function(a){this._hold(a,"lap")},_resumeCountdown:function(a){this._hold(a,null)},_hold:function(a,b){var c=h.data(a,"countdown");
if(c){if(c._hold=="pause"&&!b){c._periods=c._savePeriods;var d=c._since?"-":"+";c[c._since?"_since":"_until"]=this._determineTime(d+c._periods[0]+"y"+d+c._periods[1]+"o"+d+c._periods[2]+"w"+d+c._periods[3]+"d"+d+c._periods[4]+"h"+d+c._periods[5]+"m"+d+c._periods[6]+"s");this._addTarget(a)}c._hold=b;c._savePeriods=b=="pause"?c._periods:null;h.data(a,"countdown",c);this._updateCountdown(a,c)}},_getTimesCountdown:function(a){a=h.data(a,"countdown");return!a?null:!a._hold?a._periods:this._calculatePeriods(a,
a._show,this._get(a,"significant"),new Date)},_get:function(a,b){return a.options[b]!=null?a.options[b]:h.countdown._defaults[b]},_determineTime:function(a,b){var c=function(d){var e=new Date;e.setTime(e.getTime()+d*1E3);return e};(c=a==null?b:typeof a=="string"?function(d){d=d.toLowerCase();var e=new Date,i=e.getFullYear(),f=e.getMonth(),k=e.getDate(),j=e.getHours(),g=e.getMinutes();e=e.getSeconds();for(var m=/([+-]?[0-9]+)\s*(s|m|h|d|w|o|y)?/g,l=m.exec(d);l;){switch(l[2]||"s"){case "s":e+=parseInt(l[1],
10);break;case "m":g+=parseInt(l[1],10);break;case "h":j+=parseInt(l[1],10);break;case "d":k+=parseInt(l[1],10);break;case "w":k+=parseInt(l[1],10)*7;break;case "o":f+=parseInt(l[1],10);k=Math.min(k,h.countdown._getDaysInMonth(i,f));break;case "y":i+=parseInt(l[1],10);k=Math.min(k,h.countdown._getDaysInMonth(i,f))}l=m.exec(d)}return new Date(i,f,k,j,g,e,0)}(a):typeof a=="number"?c(a):a)&&c.setMilliseconds(0);return c},_getDaysInMonth:function(a,b){return 32-(new Date(a,b,32)).getDate()},_normalLabels:function(a){return a},
_generateHTML:function(a){var b=this._get(a,"significant");a._periods=a._hold?a._periods:this._calculatePeriods(a,a._show,b,new Date);for(var c=false,d=0,e=b,i=h.extend({},a._show),f=0;f<=6;f++){c|=a._show[f]=="?"&&a._periods[f]>0;i[f]=a._show[f]=="?"&&!c?null:a._show[f];d+=i[f]?1:0;e-=a._periods[f]>0?1:0}var k=[false,false,false,false,false,false,false];for(f=6;f>=0;f--)if(a._show[f])if(a._periods[f])k[f]=true;else{k[f]=e>0;e--}c=this._get(a,"compact");e=this._get(a,"layout");var j=c?this._get(a,
"compactLabels"):this._get(a,"labels"),g=this._get(a,"whichLabels")||this._normalLabels;f=this._get(a,"timeSeparator");var m=this._get(a,"description")||"",l=function(n){var p=h.countdown._get(a,"compactLabels"+g(a._periods[n]));return i[n]?a._periods[n]+(p?p[n]:j[n])+" ":""},o=function(n){var p=h.countdown._get(a,"labels"+g(a._periods[n]));return!b&&i[n]||b&&k[n]?'<span class="countdown_section"><span class="countdown_amount">'+a._periods[n]+"</span><br/>"+(p?p[n]:j[n])+"</span>":""};return e?this._buildLayout(a,
i,e,c,b,k):(c?'<span class="countdown_row countdown_amount'+(a._hold?" countdown_holding":"")+'">'+l(0)+l(1)+l(2)+l(3)+(i[4]?this._minDigits(a._periods[4],2):"")+(i[5]?(i[4]?f:"")+this._minDigits(a._periods[5],2):"")+(i[6]?(i[4]||i[5]?f:"")+this._minDigits(a._periods[6],2):""):'<span class="countdown_row countdown_show'+(b||d)+(a._hold?" countdown_holding":"")+'">'+o(0)+o(1)+o(2)+o(3)+o(4)+o(5)+o(6))+"</span>"+(m?'<span class="countdown_row countdown_descr">'+m+"</span>":"")},_buildLayout:function(a,
b,c,d,e,i){var f=this._get(a,d?"compactLabels":"labels"),k=this._get(a,"whichLabels")||this._normalLabels,j=function(l){return(h.countdown._get(a,(d?"compactLabels":"labels")+k(a._periods[l]))||f)[l]},g=function(l,o){return Math.floor(l/o)%10};j={desc:this._get(a,"description"),sep:this._get(a,"timeSeparator"),yl:j(0),yn:a._periods[0],ynn:this._minDigits(a._periods[0],2),ynnn:this._minDigits(a._periods[0],3),y1:g(a._periods[0],1),y10:g(a._periods[0],10),y100:g(a._periods[0],100),y1000:g(a._periods[0],
1E3),ol:j(1),on:a._periods[1],onn:this._minDigits(a._periods[1],2),onnn:this._minDigits(a._periods[1],3),o1:g(a._periods[1],1),o10:g(a._periods[1],10),o100:g(a._periods[1],100),o1000:g(a._periods[1],1E3),wl:j(2),wn:a._periods[2],wnn:this._minDigits(a._periods[2],2),wnnn:this._minDigits(a._periods[2],3),w1:g(a._periods[2],1),w10:g(a._periods[2],10),w100:g(a._periods[2],100),w1000:g(a._periods[2],1E3),dl:j(3),dn:a._periods[3],dnn:this._minDigits(a._periods[3],2),dnnn:this._minDigits(a._periods[3],3),
d1:g(a._periods[3],1),d10:g(a._periods[3],10),d100:g(a._periods[3],100),d1000:g(a._periods[3],1E3),hl:j(4),hn:a._periods[4],hnn:this._minDigits(a._periods[4],2),hnnn:this._minDigits(a._periods[4],3),h1:g(a._periods[4],1),h10:g(a._periods[4],10),h100:g(a._periods[4],100),h1000:g(a._periods[4],1E3),ml:j(5),mn:a._periods[5],mnn:this._minDigits(a._periods[5],2),mnnn:this._minDigits(a._periods[5],3),m1:g(a._periods[5],1),m10:g(a._periods[5],10),m100:g(a._periods[5],100),m1000:g(a._periods[5],1E3),sl:j(6),
sn:a._periods[6],snn:this._minDigits(a._periods[6],2),snnn:this._minDigits(a._periods[6],3),s1:g(a._periods[6],1),s10:g(a._periods[6],10),s100:g(a._periods[6],100),s1000:g(a._periods[6],1E3)};var m=c;for(c=0;c<=6;c++){g="yowdhms".charAt(c);m=m.replace(RegExp("\\{"+g+"<\\}(.*)\\{"+g+">\\}","g"),!e&&b[c]||e&&i[c]?"$1":"")}h.each(j,function(l,o){m=m.replace(RegExp("\\{"+l+"\\}","g"),o)});return m},_minDigits:function(a,b){a=""+a;if(a.length>=b)return a;a="0000000000"+a;return a.substr(a.length-b)},_determineShow:function(a){a=
this._get(a,"format");var b=[];b[0]=a.match("y")?"?":a.match("Y")?"!":null;b[1]=a.match("o")?"?":a.match("O")?"!":null;b[2]=a.match("w")?"?":a.match("W")?"!":null;b[3]=a.match("d")?"?":a.match("D")?"!":null;b[4]=a.match("h")?"?":a.match("H")?"!":null;b[5]=a.match("m")?"?":a.match("M")?"!":null;b[6]=a.match("s")?"?":a.match("S")?"!":null;return b},_calculatePeriods:function(a,b,c,d){a._now=d;a._now.setMilliseconds(0);var e=new Date(a._now.getTime());if(a._since)if(d.getTime()<a._since.getTime())a._now=
d=e;else d=a._since;else{e.setTime(a._until.getTime());if(d.getTime()>a._until.getTime())a._now=d=e}var i=[0,0,0,0,0,0,0];if(b[0]||b[1]){var f=h.countdown._getDaysInMonth(d.getFullYear(),d.getMonth()),k=h.countdown._getDaysInMonth(e.getFullYear(),e.getMonth());k=e.getDate()==d.getDate()||e.getDate()>=Math.min(f,k)&&d.getDate()>=Math.min(f,k);k=Math.max(0,(e.getFullYear()-d.getFullYear())*12+e.getMonth()-d.getMonth()+(e.getDate()<d.getDate()&&!k||k&&(e.getHours()*60+e.getMinutes())*60+e.getSeconds()<
(d.getHours()*60+d.getMinutes())*60+d.getSeconds()?-1:0));i[0]=b[0]?Math.floor(k/12):0;i[1]=b[1]?k-i[0]*12:0;d=new Date(d.getTime());f=d.getDate()==f;k=h.countdown._getDaysInMonth(d.getFullYear()+i[0],d.getMonth()+i[1]);d.getDate()>k&&d.setDate(k);d.setFullYear(d.getFullYear()+i[0]);d.setMonth(d.getMonth()+i[1]);f&&d.setDate(k)}var j=Math.floor((e.getTime()-d.getTime())/1E3);d=function(g,m){i[g]=b[g]?Math.floor(j/m):0;j-=i[g]*m};d(2,604800);d(3,86400);d(4,3600);d(5,60);d(6,1);if(j>0&&!a._since){a=
[1,12,4.3482,7,24,60,60];d=6;e=1;for(f=6;f>=0;f--){if(b[f]){if(i[d]>=e){i[d]=0;j=1}if(j>0){i[f]++;j=0;d=f;e=1}}e*=a[f]}}if(c)for(f=0;f<=6;f++)if(c&&i[f])c--;else c||(i[f]=0);return i}});h.fn.countdown=function(a){var b=Array.prototype.slice.call(arguments,1);if(a=="getTimes"||a=="settings")return h.countdown["_"+a+"Countdown"].apply(h.countdown,[this[0]].concat(b));return this.each(function(){typeof a=="string"?h.countdown["_"+a+"Countdown"].apply(h.countdown,[this].concat(b)):h.countdown._attachCountdown(this,
a)})};h.countdown=new q})(jQuery);
